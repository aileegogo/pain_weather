<div class="dashboard-wrapper" style="max-width: 900px; margin: 0 auto; padding: 20px; font-family: 'Pretendard', sans-serif; background-color: #f8fafc; min-height: 100vh;">
  
  <header style="text-align: center; margin-bottom: 40px;">
    <h1 style="color: #0f172a; font-size: 2rem; margin-bottom: 10px;">🌤️ AI 기상-건강 통합 분석 시스템</h1>
    <p style="color: #64748b; font-size: 1rem;">전 세계 기상망과 AI를 결합한 실시간 건강 리포트</p>
  </header>

  <section class="search-section" style="margin-bottom: 40px;">
    <form action="/" method="get" style="display: flex; justify-content: center; gap: 12px; background: white; padding: 20px; border-radius: 20px; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);">
      <input type="text" name="city" placeholder="분석할 도시를 입력하세요 (예: 속초시)" value="<%= @city_ko %>"
             style="flex: 1; padding: 15px 25px; border-radius: 15px; border: 2px solid #ecfdf5; background-color: #f0f9f4; font-size: 1.1rem; outline: none; transition: 0.3s; border-color: #10b981;">
      <button type="submit" class="search-btn" style="padding: 0 30px; border-radius: 15px; border: none; background-color: #10b981; color: white; font-weight: bold; cursor: pointer; transition: 0.2s; font-size: 1.1rem;">
        데이터 분석 시작
      </button>
    </form>
  </section>

  <% if @weather %>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px;">
      
      <div style="background: white; padding: 25px; border-radius: 24px; box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1); border-left: 8px solid #fbbf24;">
        <p style="color: #64748b; font-size: 0.9rem; margin-bottom: 8px;">현재 기온</p>
        <div style="display: flex; align-items: baseline; gap: 8px;">
          <h2 style="font-size: 3rem; color: #1e293b; margin: 0;"><%= @weather.temp %></h2>
          <span style="font-size: 1.5rem; color: #64748b;">°C</span>
        </div>
        <p style="margin-top: 15px; font-size: 0.9rem; color: #059669; font-weight: 600;">체감 온도 최적화 분석 중</p>
      </div>

      <div style="background: white; padding: 25px; border-radius: 24px; box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1); border-left: 8px solid #3b82f6;">
        <p style="color: #64748b; font-size: 0.9rem; margin-bottom: 8px;">대기압</p>
        <div style="display: flex; align-items: baseline; gap: 8px;">
          <h2 style="font-size: 3rem; color: #1e293b; margin: 0;"><%= @weather.pressure %></h2>
          <span style="font-size: 1.5rem; color: #64748b;">hPa</span>
        </div>
        <p style="margin-top: 15px; font-size: 0.9rem; color: #2563eb; font-weight: 600;">신체 압력 영향도: 보통</p>
      </div>
    </div>

    <section style="background: white; padding: 30px; border-radius: 24px; box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1); margin-bottom: 30px;">
      <h3 style="display: flex; align-items: center; gap: 10px; color: #0f172a; margin-top: 0; margin-bottom: 20px; font-size: 1.3rem;">
        <span style="background: #ede9fe; padding: 8px; border-radius: 12px;">🧠</span> AI 전문 분석가 소견
      </h3>
      <div style="line-height: 1.8; color: #334155; font-size: 1.05rem; background: #f1f5f9; padding: 25px; border-radius: 16px; border-left: 4px solid #8b5cf6;">
       <%# 기존 @weather.description 부분을 아래 코드로 교체 %>
       <%= @weather.ai_content.presence || "데이터 분석 중입니다..." %>     
        </div>
    </section>

    <section style="background: white; padding: 30px; border-radius: 24px; box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1);">
      <h3 style="color: #0f172a; margin-top: 0; margin-bottom: 20px; font-size: 1.3rem;">📉 주간 기압 변동 추이</h3>
      <% if @weekly_weather && @weekly_weather.size > 1 %>
        <canvas id="pressureChart" style="max-height: 250px;"></canvas>
        <% else %>
        <div style="height: 200px; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #f8fafc; border: 2px dashed #e2e8f0; border-radius: 16px;">
          <p style="color: #94a3b8; font-weight: 500;">분석 데이터 축적 중 (현재 15% 완료)</p>
          <div style="width: 200px; height: 8px; background: #e2e8f0; border-radius: 10px; margin-top: 10px; overflow: hidden;">
            <div style="width: 15%; height: 100%; background: #10b981;"></div>
          </div>
        </div>
      <% end %>
    </section>
  <footer style="clear: both; width: 100%; margin-top: 60px; padding: 30px 0; border-top: 1px solid #eee; background-color: #f9f9f9; text-align: center;">
  <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 10px;">
    
    <div>
      <%= link_to "서비스 소개", "#", style: "text-decoration: none; color: #666; font-size: 14px; margin: 0 10px;" %>
      <span style="color: #ccc;">|</span>
      <%= link_to "개인정보처리방침", "#", style: "text-decoration: none; color: #666; font-size: 14px; margin: 0 10px;" %>
    </div>
    
    <p style="color: #999; font-size: 12px; margin: 0;">
      © 2026 AI 기상-건강 통합 분석 시스템. All rights reserved.
    </p>
    
  </div>
</footer>
    
  <% end %>
</div>
<hr style="border: 0; height: 1px; background: #e2e8f0; margin: 60px 0 40px;">

<section style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 40px; padding: 0 20px; text-align: left; font-size: 0.85rem; color: #64748b; line-height: 1.7;">
  
  <div>
    <h4 style="color: #0f172a; font-size: 1rem; margin-bottom: 15px;">ℹ️ 서비스 소개 (About)</h4>
    <p>
      본 <strong>AI 기상-건강 통합 분석 시스템</strong>은 전 세계 실시간 기상 데이터(OpenWeather API)와 최신 AI 모델(GPT-4o)을 결합하여 개발되었습니다. 단순한 날씨 정보를 넘어, 기압과 기온 변화가 인체에 미치는 영향을 분석하고 사용자 맞춤형 건강 관리 리포트를 실시간으로 생성합니다.
    </p>
  </div>

  <div>
    <h4 style="color: #0f172a; font-size: 1rem; margin-bottom: 15px;">🔒 개인정보 처리방침 (Privacy Policy)</h4>
    <p>
      1. <strong>데이터 수집</strong>: 본 서비스는 사용자의 검색 키워드(도시명) 외에 어떠한 개인정보나 GPS 위치 데이터를 서버에 저장하지 않습니다.<br>
      2. <strong>쿠키 사용</strong>: 구글 애드센스 등 제3자 광고 파트너는 사용자 맞춤형 광고를 제공하기 위해 쿠키를 사용할 수 있습니다.<br>
      3. <strong>면책 조항</strong>: 본 AI 리포트는 참고용이며, 전문적인 의료 진단을 대신할 수 없습니다.
    </p>
  </div>

</section>
<style>
  .search-btn:hover { background-color: #f97316 !important; transform: translateY(-2px); }
  .search-btn:active { background-color: #ea580c !important; transform: translateY(0); }
  @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
</style>